<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>学園女子プロレス シミュレーター</title>
    <style>
      :root { color-scheme: dark; }
      * { box-sizing: border-box; }
      body {
        margin: 0;
        font-family: 'Inter', 'Noto Sans JP', system-ui, sans-serif;
        background: radial-gradient(circle at top, #1f1135, #05070f 55%);
        color: #e7e9ee;
      }
      .app { max-width: 1240px; margin: 0 auto; padding: 20px 16px 28px; }
      h1 { text-align: center; color: #f4b8ff; letter-spacing: .06em; margin: 8px 0 18px; font-size: clamp(1.2rem, 2vw, 2rem); }
      .grid { display: grid; grid-template-columns: 1fr 1.2fr 1fr; gap: 12px; }
      .card, .center { background: rgba(8,13,28,.9); border: 1px solid rgba(91,216,255,.25); border-radius: 14px; padding: 12px; }
      .center { border-color: rgba(231,112,255,.28); }
      .name { font-size: 1.15rem; font-weight: 700; color: #b8ecff; }
      .meta { color:#96a3ba; font-size:.78rem; }
      .portrait {
        margin-top: 8px; height: 170px; border-radius: 10px; background:#2a3142;
        display:flex; align-items:center; justify-content:center; text-align:center; color:#b4bed0; border:1px solid #404e66;
      }
      .shake { animation: shake .28s linear; }
      @keyframes shake { 0%{transform:translateX(0)} 20%{transform:translateX(-8px)} 40%{transform:translateX(8px)} 60%{transform:translateX(-6px)} 80%{transform:translateX(6px)} 100%{transform:translateX(0)} }
      .row { display:flex; justify-content:space-between; margin-top:8px; padding:6px 8px; background:#1a2030; border-radius:8px; font-size:.84rem; }
      .hpbar { margin-top:6px; height:8px; background:#2a3347; border-radius:999px; overflow:hidden; }
      .hpfill { height:100%; background:linear-gradient(90deg,#46f09f,#a8f56b); width:100%; transition: width .2s; }
      .tiny { margin-top:6px; font-size:.74rem; color:#9ca8be; }
      .topline { display:flex; justify-content:space-between; align-items:center; font-size:.88rem; }
      .pill { background:#4b1a63; color:#f9d0ff; border-radius:999px; padding:4px 10px; font-weight:700; }
      .move { margin-top:10px; text-align:center; border:1px solid #2d374f; border-radius:10px; padding:10px; background:#0b1224; }
      .move .label { font-size:.72rem; color:#8f9ab0; letter-spacing:.15em; }
      .move .value { margin-top:7px; font-weight:800; color:#8df2ca; min-height:24px; }
      .momentum { margin-top:12px; }
      .meter { height:14px; border-radius:999px; overflow:hidden; border:1px solid #2d3548; display:flex; background:#141a29; }
      .leftm { background:linear-gradient(90deg,#20cbff,#4d82ff); transition: width .25s; }
      .rightm { background:linear-gradient(90deg,#cb4cff,#ff5476); transition: width .25s; }
      .names { margin-top:4px; font-size:.72rem; display:flex; justify-content:space-between; color:#95a3bc; }
      .logs { margin-top:10px; height:285px; overflow:auto; border:1px solid #2f384b; border-radius:10px; background:#070d1b; padding:8px; font-size:.84rem; line-height:1.45; }
      .log { margin:0 0 7px; color:#d9e1f1; }
      .next {
        margin: 14px auto 0; width:min(700px,100%); border:none; border-radius:14px; padding:16px; color:white; font-size:1.05rem;
        font-weight:900; letter-spacing:.08em; cursor:pointer; background:linear-gradient(90deg,#d330d0,#1ba2d8);
      }
      .next:active { transform:scale(.98); }
      .next:disabled { opacity:.5; cursor:not-allowed; }
      @media (max-width: 980px){ .grid{ grid-template-columns:1fr; } .logs{height:230px;} }
    </style>
  </head>
  <body>
    <div class="app">
      <h1>学園女子プロレス・ターン制シミュレーター</h1>
      <div class="grid">
        <section class="card" id="left-card"></section>
        <section class="center">
          <div class="topline"><span id="turnLabel">Turn 1</span><span class="pill" id="phaseLabel">Opening</span></div>
          <div class="move"><div class="label">CURRENT MOVE</div><div class="value" id="currentMove">---</div></div>
          <div class="momentum"><div class="label">MOMENTUM</div><div class="meter"><div id="leftMomentum" class="leftm" style="width:50%"></div><div id="rightMomentum" class="rightm" style="width:50%"></div></div><div class="names"><span id="leftName"></span><span id="rightName"></span></div></div>
          <div class="logs" id="logs"></div>
        </section>
        <section class="card" id="right-card"></section>
      </div>
      <button id="nextBtn" class="next">NEXT TURN</button>
    </div>

    <script>
      const initialCharacters = [
        { id: 1, name: '高津小春', height: 161, power: 73, speed: 75, technique: 47, stamina: 85, mental: 96, influence: '★★', style: 'Striker', role: 'Babyface' },
        { id: 2, name: '澤出みずき', height: 158, power: 73, speed: 78, technique: 73, stamina: 73, mental: 72, influence: '■', style: 'Allrounder', role: 'Babyface' },
        { id: 4, name: '富岡加奈子', height: 168, power: 86, speed: 61, technique: 70, stamina: 74, mental: 83, influence: '★★★★', style: 'Power', role: 'Heel' },
        { id: 7, name: '副沢たまき', height: 161, power: 71, speed: 68, technique: 74, stamina: 68, mental: 68, influence: '★★', style: 'Technique', role: 'Babyface' },
        { id: 6, name: '深町真琴', height: 160, power: 55, speed: 90, technique: 53, stamina: 85, mental: 63, influence: '★★★', style: 'Speed', role: 'Babyface' },
        { id: 11, name: '橘玲美', height: 171, power: 71, speed: 73, technique: 89, stamina: 75, mental: 74, influence: '★★★★', style: 'Submission', role: 'Heel' },
        { id: 12, name: '生駒エリカ', height: 153, power: 78, speed: 71, technique: 55, stamina: 76, mental: 82, influence: '★★★', style: 'Brawler', role: 'Heel' },
        { id: 16, name: '川野辺菜穂子', height: 168, power: 66, speed: 80, technique: 69, stamina: 71, mental: 76, influence: '★★★★', style: 'Technique', role: 'Babyface' },
        { id: 17, name: '岸ゆみえ', height: 155, power: 43, speed: 48, technique: 78, stamina: 64, mental: 61, influence: '★★', style: 'Technique', role: 'Babyface' },
        { id: 18, name: '大河内紗代子', height: 164, power: 93, speed: 72, technique: 63, stamina: 68, mental: 77, influence: '★★★★★', style: 'Power', role: 'Heel' },
        { id: 21, name: '四条あずさ', height: 163, power: 64, speed: 68, technique: 62, stamina: 67, mental: 62, influence: '★★', style: 'Allrounder', role: 'Heel' },
      ];
      const styleMoves = {
        Striker: ['ローキック', 'ミドルキック', 'ジャンピングニー'], Allrounder: ['ドロップキック', 'DDT', 'ブレーンバスター'],
        Power: ['ショルダータックル', 'ラリアット', 'パワーボム'], Technique: ['アームホイップ', 'ドラゴンスクリュー', 'スープレックス'],
        Speed: ['スライディングキック', 'ヘッドシザーズ', '旋回式DDT'], Submission: ['腕ひしぎ十字固め', '逆エビ固め', '三角締め'], Brawler: ['エルボースマッシュ', 'バックハンドブロー', '場外乱闘パンチ'],
      };
      const phases = [{limit:4,name:'Opening',mul:.9},{limit:8,name:'Mid',mul:1.05},{limit:12,name:'End',mul:1.2},{limit:999,name:'Climax',mul:1.4}];
      const hpFromStamina = (s)=>Math.round(s*1.9);
      const pick = ()=> initialCharacters[Math.floor(Math.random()*initialCharacters.length)];
      const pair = ()=> { const a=pick(); let b=pick(); while(a.id===b.id) b=pick(); return [a,b]; };
      const move = (style)=> (styleMoves[style]||['エルボー'])[Math.floor(Math.random()*3)];
      const phase = (turn)=> phases.find(p=>turn<=p.limit);
      const audioEngine = (()=>{ let ctx; const ensure=()=>{ ctx ||= new (window.AudioContext||window.webkitAudioContext)(); if(ctx.state==='suspended') ctx.resume(); return ctx; };
        const beep=(f,d,t,v)=>{ const c=ensure(),o=c.createOscillator(),g=c.createGain(); o.type=t; o.frequency.value=f; g.gain.value=v; o.connect(g); g.connect(c.destination); o.start(); g.gain.exponentialRampToValueAtTime(0.001,c.currentTime+d); o.stop(c.currentTime+d); };
        return { click(){beep(520,.04,'square',.05);}, impact(){beep(180,.09,'sawtooth',.07); setTimeout(()=>beep(120,.05,'triangle',.05),28);}, finish(){beep(700,.06,'square',.06); setTimeout(()=>beep(850,.1,'square',.06),70);} };
      })();

      const [l, r] = pair();
      const state = { left:{...l,maxHp:hpFromStamina(l.stamina),hp:hpFromStamina(l.stamina)}, right:{...r,maxHp:hpFromStamina(r.stamina),hp:hpFromStamina(r.stamina)}, turn:1, momentum:0, logs:['ゴング！試合開始！'], winner:null };

      const leftCard = document.getElementById('left-card');
      const rightCard = document.getElementById('right-card');
      const turnLabel = document.getElementById('turnLabel');
      const phaseLabel = document.getElementById('phaseLabel');
      const currentMove = document.getElementById('currentMove');
      const logs = document.getElementById('logs');
      const leftMomentum = document.getElementById('leftMomentum');
      const rightMomentum = document.getElementById('rightMomentum');
      const leftName = document.getElementById('leftName');
      const rightName = document.getElementById('rightName');
      const nextBtn = document.getElementById('nextBtn');

      function fighterHTML(f){
        const hpRate = Math.max(0, (f.hp/f.maxHp)*100);
        return `<div class='name'>${f.name}</div><div class='meta'>${f.role} / ${f.style} / ${f.height}cm</div>
          <div class='portrait'><div><div style='font-size:.78rem;color:#95a2b8'>立ち絵プレースホルダー</div><div style='margin-top:5px'>${f.name}</div></div></div>
          <div class='row'><span>HP</span><span>${Math.max(0,f.hp)} / ${f.maxHp}</span></div><div class='hpbar'><div class='hpfill' style='width:${hpRate}%'></div></div>
          <div class='row'><span>P / S / T</span><span>${f.power} / ${f.speed} / ${f.technique}</span></div><div class='tiny'>Influence: ${f.influence} ・ Mental: ???</div>`;
      }
      function render(){
        leftCard.innerHTML = fighterHTML(state.left);
        rightCard.innerHTML = fighterHTML(state.right);
        leftName.textContent = state.left.name;
        rightName.textContent = state.right.name;
        turnLabel.textContent = `Turn ${state.turn}`;
        phaseLabel.textContent = phase(state.turn).name;
        const leftRatio = Math.max(0, 50 + state.momentum/2);
        leftMomentum.style.width = leftRatio + '%';
        rightMomentum.style.width = (100-leftRatio) + '%';
        logs.innerHTML = state.logs.map(l=>`<p class='log'>・${l}</p>`).join('');
        if (state.winner) { nextBtn.textContent = `${state.winner} WIN!`; nextBtn.disabled = true; }
      }

      function shake(side){
        const target = side === 'left' ? leftCard.querySelector('.portrait') : rightCard.querySelector('.portrait');
        target.classList.remove('shake'); void target.offsetWidth; target.classList.add('shake');
      }

      function nextTurn(){
        if(state.winner) return;
        audioEngine.click();
        const p = phase(state.turn);
        const attackerLeft = Math.random() + state.momentum * 0.003 > 0.5;
        const atk = attackerLeft ? state.left : state.right;
        const def = attackerLeft ? state.right : state.left;
        const m = move(atk.style);
        const offense = atk.power*.45 + atk.speed*.25 + atk.technique*.3;
        const defense = def.stamina*.35 + def.mental*.25;
        const bonus = attackerLeft ? Math.max(state.momentum,0)*.09 : Math.max(-state.momentum,0)*.09;
        const swing = Math.random()*8 + 2;
        const dmg = Math.max(4, Math.round((offense*.22 + bonus + swing - defense*.09)*p.mul));
        def.hp -= dmg;
        const gain = Math.min(16, Math.max(6, Math.round(dmg*.6)));
        state.momentum = attackerLeft ? Math.min(100, state.momentum+gain) : Math.max(-100, state.momentum-gain);
        currentMove.textContent = `${atk.name}：${m}`;
        shake(attackerLeft ? 'right' : 'left');
        audioEngine.impact();
        const base = `Turn ${state.turn} [${p.name}] ${atk.name}の${m}！ ${def.name}に${dmg}ダメージ。`;
        if(def.hp<=0){
          const finish = Math.random() + atk.technique * .004 > .6 ? 'フォール勝ち' : 'ギブアップ勝ち';
          state.winner = atk.name;
          state.logs.unshift(`${base} ${atk.name}が${finish}で決着！`);
          audioEngine.finish();
        } else {
          state.logs.unshift(base);
          state.turn += 1;
        }
        state.logs = state.logs.slice(0,12);
        render();
      }
      nextBtn.addEventListener('click', nextTurn);
      render();
    </script>
  </body>
</html>
